<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In / Sign Up / Forgot Password</title>
    <link rel="stylesheet" href="../static/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>
<body>
    <div id="container" class="container sign-in">
        <!-- FORM SECTION -->
         
        <div class="row">
            <!-- SIGN UP -->
            <div class="col align-items-center flex-col sign-up">
                <div class="form-wrapper align-items-center">
                    <div class="form sign-up">
                        <div class="input-group">
                            <i class="bx bxs-user"></i>
                            <input type="text" id="username" placeholder="Username" aria-label="Enter your username" required>
                        </div>
                        <div class="input-group">
                            <i class="bx bx-mail-send"></i>
                            <input type="email" id="email" placeholder="Email" aria-label="Enter your email" required>
                        </div>
                        <div class="input-group">
                            <i class="bx bxs-lock-alt"></i>
                            <input type="password" id="password" placeholder="Password" aria-label="Enter your password" autocomplete="new-password" required>
                        </div>
                        <div class="input-group">
                            <i class="bx bxs-lock-alt"></i>
                            <input type="password" id="confirm-password" placeholder="Confirm password" aria-label="Confirm your password" autocomplete="new-password" required>
                        </div>
                        <button type="submit">Sign Up</button>
                        <p>
                            <span>Already have an account?</span>
                            <b onclick="toggleToSignIn()" class="pointer">Sign in here</b>
                        </p>
                    </div>
                </div>
            </div>
            <!-- END SIGN UP -->
            
            <!-- SIGN IN -->
            <!-- <div class="col align-items-center flex-col sign-in">
                <div class="form-wrapper align-items-center">
                    <div class="form sign-in">
                        <form action="/login" method="POST" onsubmit="loginUser(event)"></form>
                        <div class="input-group">
                            <i class="bx bx-mail-send"></i>
                            <input type="email" id="login-email" placeholder="Email" aria-label="Enter your email" required>
                        </div>
                        <div class="input-group">
                            <i class="bx bxs-lock-alt"></i>
                            <input type="password" id="login-password" placeholder="Password" aria-label="Enter your password" required>
                        </div>
                       
                        <p>
                            <b onclick="toggleToForgotPassword()" class="pointer">Forgot password?</b>
                        </p>
                        <button type="submit">Log In</button>
                        <p>
                            <span>Don't have an account?</span>
                            <b onclick="toggleToSignUp()" class="pointer">Sign up here</b>
                        </p>
                    </div>
                </div>
            </div> -->





            <!-- SIGN IN -->
<div class="col align-items-center flex-col sign-in">
    <div class="form-wrapper align-items-center">
        <div class="form sign-in">
            <form onsubmit="loginUser(event)">
                <div class="input-group">
                    <i class="bx bx-mail-send"></i>
                    <input type="email" id="login-email" placeholder="Email" aria-label="Enter your email" required>
                </div>
                <div class="input-group">
                    <i class="bx bxs-lock-alt"></i>
                    <input type="password" id="login-password" placeholder="Password" aria-label="Enter your password" required>
                </div>

                <p>
                    <b onclick="toggleToForgotPassword()" class="pointer">Forgot password?</b>
                </p>
                <button type="submit">Log In</button>
                <p>
                    <span>Don't have an account?</span>
                    <b onclick="toggleToSignUp()" class="pointer">Sign up here</b>
                </p>
            </form>
        </div>
    </div>
</div>
<!-- END SIGN IN -->



            
            <!-- END SIGN IN -->
            
            <!-- FORGOT PASSWORD -->
            <div class="col align-items-center flex-col forgot-password">
                <div class="form-wrapper align-items-center">
                    <div class="form forgot-password">
                        <div class="input-group">
                            <i class="bx bx-mail-send"></i>
                            <input type="email" placeholder="Email" aria-label="Enter your registered email" required>
                        </div>
                        <button type="submit">Reset Password</button>
                        <p>
                            <span>Remembered your password?</span>
                            <b onclick="toggleToSignIn()" class="pointer">Log in here</b>
                        </p>
                    </div>
                </div>
            </div>
            <!-- END FORGOT PASSWORD -->
        </div>
        
        <!-- CONTENT SECTION -->
        <div class="row content-row">
            <!-- SIGN IN CONTENT -->
            <div class="col align-items-center flex-col">
                <div class="text sign-in">
                    <h2>Welcome</h2>
                    <p>Log in to access your account and stay connected.</p>
                </div>
                <div class="img sign-in"></div>
            </div>
            
            <!-- SIGN UP CONTENT -->
            <div class="col align-items-center flex-col">
                <div class="img sign-up"></div>
                <div class="text sign-up">
                    <h2>Join with us</h2>
                    <p>Create an account to explore more features.</p>
                </div>
            </div>
            
            <!-- FORGOT PASSWORD CONTENT -->
            
        </div>
        <!-- END CONTENT SECTION -->
    </div>
    <script src="../static/js/main.js"></script>
    <script>
        // Function to handle login
        async function loginUser(event) {
            event.preventDefault();  // Prevent form from submitting the traditional way

            const data = {
                email: document.getElementById('login-email').value,
                password: document.getElementById('login-password').value
            };

            const response = await fetch('/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            const result = await response.json();
            if (response.ok) {
        // If login is successful, store the token (optional, for further use)
        localStorage.setItem('auth_token', result.token);
        alert(result.message || "Login successful.");
        
        // Redirect to dashboard
        window.location.href = '/dashboard';
    } else {


            alert(result.message || result.error);
        }
    }
    </script>

<script>
async function signupUser(event) {
    event.preventDefault(); // Prevent the form from submitting traditionally

    const data = {
        username: document.getElementById('username').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value,
        confirm_password: document.getElementById('confirm-password').value
    };
    console.log("Data to be sent:", data);  // Debugging line


    try {
        const response = await fetch('/users', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        });

        const result = await response.json();
        console.log("Response from server:", result); 

        if (response.ok) {
            alert(result.message || "User created successfully!");
            // Optionally redirect to login page
            window.location.href = '/login';
        } else {
            alert(result.error || "An error occurred during sign-up.");
        }
    } catch (error) {
        console.error("Error during sign-up:", error);
        alert("Something went wrong. Please try again.");
    }
}

</script>

</body>
</html>